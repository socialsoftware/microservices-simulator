package {{packageName}};

import static {{basePackage}}.ms.TransactionalModel.{{transactionModel}};
import static {{basePackage}}.{{projectName}}.microservices.exception.{{ProjectName}}ErrorMessage.*;

{{#each imports}}
{{this}}
{{/each}}

@Service
public class {{aggregateName}}Functionalities {
{{#each dependencies}}
    @Autowired{{#unless required}}(required = false){{/unless}}
    private {{type}} {{name}};

{{/each}}

    @Autowired
    private Environment env;

    private TransactionalModel workflowType;

    @PostConstruct
    public void init() {
        String[] activeProfiles = env.getActiveProfiles();
        if (Arrays.asList(activeProfiles).contains(SAGAS.getValue())) {
            workflowType = SAGAS;
        } else {
            throw new {{ProjectName}}Exception(UNDEFINED_TRANSACTIONAL_MODEL);
        }
    }

{{#each businessMethods}}
    public {{returnType}} {{name}}({{#each parameters}}{{type}} {{name}}{{#unless @last}}, {{/unless}}{{/each}}){{#if throwsException}} throws {{../ProjectName}}Exception{{/if}} {
        {{{body}}}
    }

{{/each}}
{{#if checkInputMethod}}
    {{{checkInputMethod}}}
{{/if}}
}